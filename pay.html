<!DOCTYPE html> 
<html lang="en"> 
<head> 
<meta charset="UTF-8"> 
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> 
<title>NIMCREDIT REPAYMENT</title> 
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js"></script> 
<style>
* { margin: 0; padding: 0; box-sizing: border-box; } 
body { font-family: system-ui; background: #F7F7F9; color: #333; min-height: 100vh; }

/* Main container */
.container { max-width: 500px; margin: 0 auto; padding-bottom: 20px; } 
.amount-section { background: #000; color: white; padding: 20px; } 
.amount-row { display: flex; align-items: baseline; gap: 8px; font-size: 14px; margin-bottom: 8px; } 
.amount-label { font-weight: 600; color: #DEDFE0; } 
.amount { font-weight: 600; } 
.discount { color: #FE8B00; font-size: 14px; font-weight: 500; } 
.qr-section { background: white; padding: 16px; margin: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); } 
.countdown-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; font-size: 14px; } 
.countdown-text { color: #333; } 
.countdown-timer { font-weight: bold; color: #FE8B00; } 
.qr-content { text-align: center; } 
.qr-container { width: 200px; height: 200px; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; } 
.qr-placeholder { width: 100%; height: 100%; background: #f0f0f0; border: 2px dashed #ccc; display: flex; align-items: center; justify-content: center; color: #666; font-size: 14px; } 
#qrcode { display: flex; align-items: center; justify-content: center; } 
#qrcode table { border-collapse: collapse; } 
#qrcode td { border: none; padding: 0; margin: 0; } 
.paytm-button { background: #f5f5f5; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; font-size: 16px; font-weight: 600; display: flex; align-items: center; justify-content: space-between; cursor: pointer; width: 100%; margin-top: 15px; transition: background 0.2s; } 
.paytm-button:hover { background: #ebebeb; } 
.paytm-logo { height: 24px; object-fit: contain; } 
.phonepe-logo { height: 24px; object-fit: contain; transform: translateX(-16px) scale(3.6); transform-origin: left center; } 
.hand-icon { width: 24px; height: 24px; object-fit: contain; } 
.payment-step { background: white; border-radius: 12px; margin: 0 20px 20px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); } 
.step-title { font-size: 12px; color: gray; margin-bottom: 15px; font-weight: 500; } 
.upi-container { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; } 
.upi-input { flex: 1; background: #f5f5f5; border: 1px solid #e0e0e0; font-weight: bold; border-radius: 8px; padding: 15px 0; text-align: center; font-size: 14px; color: #333; cursor: default; user-select: all; } 
.copy-btn { background: #007AFF; color: white; border: none; border-radius: 8px; padding: 15px 10px; font-size: 14px; font-weight: 600; cursor: pointer; transition: background 0.2s; min-width: 70px; } 
.copy-btn:hover { background: #0056CC; } 
.copy-btn:active { background: #004BB5; } 
.utr-section { margin-top: 10px; } 
.utr-input { width: 100%; background: #f5f5f5; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; font-size: 14px; color: #333; margin-bottom: 20px; } 
.utr-input::placeholder { color: #999; } 
.submit-btn { width: 100%; background: #007AFF; color: white; border: none; border-radius: 8px; padding: 15px; font-size: 16px; font-weight: 600; cursor: pointer; transition: background 0.2s; } 
.submit-btn:hover { background: #0056CC; } 
.submit-btn:active { background: #004BB5; } 
.submit-btn:disabled { background: #ccc; cursor: not-allowed; } 
.tip-section { text-align: center; color: #666; font-size: 12px; margin: 20px; } 
.tip-section a { color: #FE8B00; text-decoration: underline; cursor: pointer; } 
.status-section { padding: 60px 20px; text-align: center; } 
.status-icon { width: 80px; height: 80px; border-radius: 50%; margin: 0 auto 30px; display: flex; align-items: center; justify-content: center; font-size: 40px; font-weight: bold; } 
.status-icon.succeed { background: #28a745; color: white; } 
.status-icon.failed { background: #868e96; color: white; } 
.status-message { font-size: 24px; font-weight: 600; margin-bottom: 20px; } 
.status-message.succeed { color: #28a745; } 
.status-message.failed { color: #868e96; } 
.status-tip { color: #868e96; font-size: 10px; text-align: center; } 
.status-tip a { color: #ff9500; text-decoration: underline; cursor: pointer; } 
.toast-notification { position: fixed; top: 20px; right: 20px; background: #dc3545; color: white; padding: 12px 20px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 5000; font-size: 14px; font-weight: 500; max-width: 300px; opacity: 0; transform: translateX(100%); transition: all 0.3s; } 
.toast-notification.show { opacity: 1; transform: translateX(0); } 
.loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 2000; } 
.loading-spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite; } 
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } 
.utr-guide-overlay { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.8); z-index: 4000; display: none; } 
.utr-guide-modal { background: white; width: 100vw; height: 100vh; } 
.payment-help-overlay { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.5); z-index: 4000; display: none; align-items: center; justify-content: center; padding: 20px; } 
.payment-help-modal { background: white; border-radius: 12px; max-width: 400px; width: 100%; max-height: 80vh; overflow: hidden; box-shadow: 0 8px 32px rgba(0,0,0,0.3); position: relative; } 
.payment-help-close { position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 20px; color: #666; cursor: pointer; padding: 2px; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border-radius: 50%; z-index: 1; } 
.payment-help-close:hover { background: #f0f0f0; } 
.payment-help-content { padding: 30px 20px 20px; } 
.payment-help-input-group { background: #f0f0f0; border-radius: 8px; padding: 15px; margin-bottom: 20px; } 
.payment-help-input { width: 100%; border: none; background: transparent; font-size: 16px; color: #666; outline: none; } 
.payment-help-submit { width: 100%; background: #007AFF; color: white; border: none; border-radius: 8px; padding: 15px; font-size: 14px; font-weight: 600; cursor: pointer; margin-bottom: 20px; } 
.payment-help-submit:hover { background: #0056CC; } 
.payment-help-section { padding-top: 12px; } 
.utr-guide-header { background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e9ecef; display: flex; justify-content: space-between; align-items: center; } 
.utr-guide-title { font-size: 18px; font-weight: 600; color: #333; margin: 0; } 
.utr-guide-close { background: none; border: none; font-size: 24px; color: #666; cursor: pointer; padding: 5px; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; } 
.utr-guide-content { height: calc(100vh - 70px); overflow: scroll; -webkit-overflow-scrolling: touch; padding: 20px; touch-action: pan-y; } 
.bank-screenshot { margin-bottom: 6vw; } 
.bank-screenshot:last-child { margin-bottom: 0; } 
.bank-name { font-size: 16px; font-weight: 600; color: #5865f2; margin-bottom: 3vw; text-align: center; } 
.screenshot-placeholder { text-align: center; position: relative; } 
.bank-image { max-width: 100%; height: auto; border-radius: 2vw; box-shadow: 0 1vw 3vw rgba(0,0,0,0.1); }

/* Customer info section */
.customer-section { 
    background: white; 
    margin: 15px 20px; 
    padding: 15px; 
    border-radius: 12px; 
    box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
    display: flex; 
    align-items: center; 
    gap: 15px; 
}
.customer-avatar { 
    width: 50px; 
    height: 50px; 
    background: linear-gradient(135deg, #007AFF, #0056CC); 
    border-radius: 50%; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    color: white; 
    font-size: 22px; 
    font-weight: bold; 
}
.customer-info h3 { 
    font-size: 16px; 
    font-weight: 600; 
    margin-bottom: 5px; 
    color: #333; 
}
.customer-info p { 
    font-size: 14px; 
    color: #666; 
}
</style>
</head> 
<body>

<!-- Customer Info Section -->
<div class="customer-section">
    <div class="customer-avatar" id="customerAvatar">C</div>
    <div class="customer-info">
        <h3 id="customerName">Customer Name</h3>
        <p id="customerPhone">Phone: Loading...</p>
    </div>
</div>

<!-- Main Payment Container -->
<div class="container"> 
    <div class="amount-section"> 
        <div class="amount-row"> 
            <div class="amount-label">Amount Payable:</div> 
            <div class="amount"><span class="currency">₹</span><span id="amountDisplay">0.00</span></div> 
        </div> 
        <div class="discount">Get ₹0.01 off</div> 
    </div> 
    <div class="qr-section"> 
        <div class="countdown-header"> 
            <div class="countdown-text">Scan the <span style="font-weight: bold; color: red;">one-time</span> QR code to pay:</div> 
            <div class="countdown-timer" id="countdown">20:00</div> 
        </div> 
        <div class="qr-content"> 
            <div class="qr-container"> 
                <div id="qrcode"></div> 
                <div class="qr-placeholder" style="display: none;">QR Code Loading...</div> 
            </div> 
        </div> 
        <button class="paytm-button" onclick="openPayTM()"> 
            <img src="https://nt.m-trader.pro/images/cashier/aggregation/paytm.png" alt="PayTM" class="paytm-logo"> 
            <img src="https://nt.m-trader.pro/images/cashier/aggregation/finger.png" alt="Finger" class="hand-icon"> 
        </button> 
        <button class="paytm-button" onclick="openPhonePe()"> 
            <img src="https://nt.m-trader.pro/images/cashier/aggregation/phonepe.png" alt="PhonePe" class="phonepe-logo"> 
            <img src="https://nt.m-trader.pro/images/cashier/aggregation/finger.png" alt="Finger" class="hand-icon"> 
        </button> 
    </div> 
    <div class="payment-step"> 
        <div class="step-title">1.Copy the UPI below and <span style="color: #FE8B00; font-weight: 600;">transfer ₹<span id="transferAmount">0.00</span></span></div> 
        <div class="upi-container"> 
            <input type="text" class="upi-input" id="upi-input" value="" readonly> 
            <button class="copy-btn" onclick="copyUPI()">Copy</button> 
        </div> 
        <div class="step-title" style="color: red; font-size: 11px; margin-top: -10px; margin-bottom: 10px;">Tip: Don't save the upi, this upi is valid for 20 minutes</div> 
        <div class="utr-section"> 
            <div class="step-title">2.Fill in UTR after payment</div> 
            <input type="text" autocomplete="off" class="utr-input" id="utr-input" placeholder="Please enter the 12-digit UTR" maxlength="12" pattern="[0-9]*" inputmode="numeric"> 
            <button class="submit-btn" onclick="submitUTR()">Submit UTR</button> 
        </div> 
    </div> 
    <div class="tip-section">Tip: How to get UTR? Please <a href="#" onclick="showUTRGuideModal()">click here</a></div> 
</div>

<!-- UTR Guide Modal --> 
<div id="utrGuideModal" class="utr-guide-overlay"> 
    <div class="utr-guide-modal"> 
        <div class="utr-guide-header"> 
            <h2 class="utr-guide-title">How to Find Your UTR?</h2> 
            <button class="utr-guide-close" onclick="closeUTRGuideModal()">×</button> 
        </div> 
        <div class="utr-guide-content"> 
            <div class="bank-screenshot"><h3 class="bank-name">MobiKwik</h3><div class="screenshot-placeholder"><img src="https://nt.m-trader.pro/images/cashier/aggregation/bill-screen/mobikwik.jpg" alt="MobiKwik UTR" class="bank-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"><div style="display:none; padding: 20px; color: #666;">Image failed to load</div></div></div> 
            <div class="bank-screenshot"><h3 class="bank-name">Freecharge</h3><div class="screenshot-placeholder"><img src="https://nt.m-trader.pro/images/cashier/aggregation/bill-screen/freecharge.jpg" alt="Freecharge UTR" class="bank-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"><div style="display:none; padding: 20px; color: #666;">Image failed to load</div></div></div> 
            <div class="bank-screenshot"><h3 class="bank-name">Gpay</h3><div class="screenshot-placeholder"><img src="https://nt.m-trader.pro/images/cashier/aggregation/bill-screen/gpay.jpg" alt="Gpay UTR" class="bank-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"><div style="display:none; padding: 20px; color: #666;">Image failed to load</div></div></div> 
            <div class="bank-screenshot"><h3 class="bank-name">PayTM</h3><div class="screenshot-placeholder"><img src="https://nt.m-trader.pro/images/cashier/aggregation/bill-screen/paytm.jpg" alt="PayTM UTR" class="bank-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"><div style="display:none; padding: 20px; color: #666;">Image failed to load</div></div></div> 
            <div class="bank-screenshot"><h3 class="bank-name">PhonePe</h3><div class="screenshot-placeholder"><img src="https://nt.m-trader.pro/images/cashier/aggregation/bill-screen/phonepe.jpg" alt="PhonePe UTR" class="bank-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"><div style="display:none; padding: 20px; color: #666;">Image failed to load</div></div></div> 
        </div> 
    </div> 
</div>

<!-- Loading overlay --> 
<div id="loadingOverlay" class="loading-overlay"><div class="loading-spinner"></div></div>

<script> 
// Get parameters from URL 
const urlParams = new URLSearchParams(window.location.search); 
let paymentData = { 
    amount: parseFloat(urlParams.get('amt')) || parseFloat(urlParams.get('amount')) || 0, 
    name: decodeURIComponent(urlParams.get('name') || 'Customer'), 
    phone: urlParams.get('phone') || urlParams.get('ph') || 'Not Provided', 
    upi: decodeURIComponent(urlParams.get('upi') || urlParams.get('vpa') || ''),
    reference: urlParams.get('ref') || urlParams.get('reference') || ''
};

// Initialize page on load
document.addEventListener('DOMContentLoaded', function() {
    // Display customer info
    document.getElementById('customerName').textContent = paymentData.name;
    document.getElementById('customerPhone').textContent = `Phone: ${paymentData.phone}`;
    document.getElementById('customerAvatar').textContent = paymentData.name.charAt(0).toUpperCase();
    
    // Display payment info
    document.getElementById('amountDisplay').textContent = paymentData.amount.toLocaleString('en-IN', {minimumFractionDigits: 2}); 
    document.getElementById('transferAmount').textContent = paymentData.amount.toLocaleString('en-IN', {minimumFractionDigits: 2}); 
    document.getElementById('upi-input').value = maskUPI(paymentData.upi) || 'UPI not provided';
    
    // Setup UTR validation
    const utrInput = document.getElementById('utr-input'); 
    if (utrInput) { 
        utrInput.addEventListener('input', function(e) { 
            e.target.value = e.target.value.replace(/[^0-9]/g, ''); 
        }); 
    }
    
    // Start 20 minute countdown
    startCountdown();
    // Generate QR Code
    generateQRCode();
});

// UPI masking function 
function maskUPI(upi) { 
    if (!upi || upi.length < 8) return upi; 
    const start = upi.substring(0, 3); 
    const end = upi.substring(upi.length - 4); 
    const middle = '*'.repeat(Math.max(4, upi.length - 7)); 
    return start + middle + end; 
} 

// Copy UPI function 
function copyUPI() { 
    navigator.clipboard.writeText(paymentData.upi).then(() => { 
        showToast('UPI copied successfully'); 
    }).catch(() => { 
        showToast('Copy failed, please try again'); 
    }); 
} 

// 20 Minute Countdown timer 
let countdownTimer = null; 
let totalSeconds = 20 * 60; // 20 Minutes

function startCountdown() { 
    function updateCountdown() { 
        if (totalSeconds <= 0) { 
            clearInterval(countdownTimer); 
            document.getElementById('countdown').textContent = '00:00';
            showToast('Payment session expired! Please generate new link');
            return; 
        } 
        totalSeconds--; 
        const minutes = Math.floor(totalSeconds / 60); 
        const seconds = totalSeconds % 60; 
        document.getElementById('countdown').textContent = 
            String(minutes).padStart(2, '0') + ':' + String(seconds).padStart(2, '0'); 
    } 
    updateCountdown(); 
    countdownTimer = setInterval(updateCountdown, 1000); 
} 

// Generate QR Code 
function generateQRCode() { 
    if (!paymentData.upi || paymentData.amount <= 0) return; 
    const qrcodeData = `upi://pay?pa=${paymentData.upi}&pn=NimCredit&am=${paymentData.amount}&cu=INR`; 
    try { 
        $('#qrcode').qrcode({ 
            width: 200, 
            height: 200, 
            correctLevel: 0, 
            render: "table", 
            text: qrcodeData, 
        }); 
    } catch (error) { 
        console.error('QR Code generation failed:', error); 
        $('.qr-placeholder').show(); 
    } 
} 

// Open apps functions
function openPayTM() { 
    window.location.href = `paytmmp://cash_wallet?pa=${paymentData.upi}&pn=NimCredit&tr=${Date.now()}&am=${paymentData.amount}&cu=INR`;
} 

function openPhonePe() { 
    const phonepeData = { 
        contact: { vpa: paymentData.upi, type: "VPA" }, 
        p2pPaymentCheckoutParams: { 
            note: "NimCredit Payment", 
            isByDefaultKnownContact: true, 
            initialAmount: paymentData.amount * 100, 
            currency: "INR" 
        } 
    }; 
    const encodedData = btoa(JSON.stringify(phonepeData)); 
    window.location.href = `phonepe://native?data=${encodedData}&id=p2ppayment`; 
} 

// Submit UTR function 
function submitUTR() { 
    const utr = document.getElementById('utr-input').value.trim(); 
    const btn = document.querySelector('.submit-btn'); 
    if (!utr || utr.length !== 12 || !/^\d{12}$/.test(utr)) { 
        showToast('Please enter valid 12-digit UTR'); 
        return; 
    } 
    btn.disabled = true; 
    btn.textContent = 'Submitting...'; 

    // Simulate API call
    setTimeout(() => { 
        showToast('UTR submitted successfully'); 
        btn.textContent = 'Submitted ✓'; 
    }, 1500); 
} 

// Toast notification function 
function showToast(message) { 
    const toast = document.createElement('div'); 
    toast.className = 'toast-notification'; 
    toast.textContent = message; 
    document.body.appendChild(toast); 
    setTimeout(() => toast.classList.add('show'), 100); 
    setTimeout(() => { 
        toast.classList.remove('show'); 
        setTimeout(() => toast.remove(), 300); 
    }, 3000); 
} 

// Modal functions 
function showUTRGuideModal() { 
    document.getElementById('utrGuideModal').style.display = 'block'; 
} 
function closeUTRGuideModal() { 
    document.getElementById('utrGuideModal').style.display = 'none'; 
}
</script> 
</body> 
</html>